---
description: ç½‘æ˜“äº‘ä¿¡ç™½æ¿é¡¹ç›®é…ç½®è§„èŒƒ
globs: ["vite.config.*", "package.json", ".env*", "tsconfig*.json"]
alwaysApply: true
---

# ç½‘æ˜“äº‘ä¿¡ç™½æ¿é¡¹ç›®é…ç½®è§„èŒƒ

åŸºäº[å®˜æ–¹æ–‡æ¡£v3.9.15](https://doc.yunxin.163.com/whiteboard/api-refer/web/typedoc/Latest/zh/html/index.html)çš„é¡¹ç›®é…ç½®æœ€ä½³å®è·µã€‚

## ç¯å¢ƒå˜é‡é…ç½®

### å¿…éœ€çš„ç¯å¢ƒå˜é‡


### ç¯å¢ƒåŒºåˆ†é…ç½®
```bash
# .env.development
VITE_APP_DEBUG=true                 # å¼€å‘ç¯å¢ƒå¯ç”¨è°ƒè¯•
VITE_APP_RECORD=true                # å¼€å‘ç¯å¢ƒå¯ç”¨å½•åˆ¶

# .env.production  
VITE_APP_DEBUG=false                # ç”Ÿäº§ç¯å¢ƒå…³é—­è°ƒè¯•
VITE_APP_RECORD=false               # ç”Ÿäº§ç¯å¢ƒå…³é—­å½•åˆ¶
```

## TypeScript é…ç½®

### tsconfig.json æ¨èé…ç½®
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": [
    "src/**/*.ts",
    "src/**/*.d.ts", 
    "src/**/*.tsx",
    "src/**/*.vue"
  ],
  "exclude": [
    "node_modules",
    "dist"
  ]
}
```

### ç™½æ¿ç›¸å…³ç±»å‹å£°æ˜
```typescript
// src/typings/global.d.ts
declare global {
  interface Window {
    WhiteBoardSDK: typeof import('@/typings/WhiteBoardSDK').default
    ToolCollection: typeof import('@/typings/ToolCollection').default
    RecordPlayer: typeof import('@/typings/RecordPlayer').default
    whiteboardAPI?: any  // å¼€å‘è°ƒè¯•API
    whiteboardDebug?: any // è°ƒè¯•å·¥å…·
  }
}

export {}
```

## Vite é…ç½®ä¼˜åŒ–

### vite.config.ts æ¨èè®¾ç½®
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  
  // ç™½æ¿SDKä¼˜åŒ–é…ç½®
  optimizeDeps: {
    include: [
      'crypto-js',
      'crypto-js/sha1'
    ]
  },
  
  // æ„å»ºä¼˜åŒ–
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          // ç™½æ¿SDKç›¸å…³ä»£ç å•ç‹¬æ‰“åŒ…
          whiteboard: ['crypto-js'],
          vendor: ['vue', 'vue-router', 'pinia']
        }
      }
    },
    // ç¡®ä¿å…¼å®¹æ€§
    target: 'es2015'
  },
  
  // å¼€å‘æœåŠ¡å™¨é…ç½®
  server: {
    host: '0.0.0.0',  // å…è®¸å¤–éƒ¨è®¿é—®ï¼Œä¾¿äºæµ‹è¯•
    port: 5173,
    cors: true,       // å…è®¸è·¨åŸŸï¼Œç™½æ¿èµ„æºå¯èƒ½éœ€è¦
    https: false      // å¦‚éœ€HTTPSï¼Œç™½æ¿åŠŸèƒ½æ›´å®Œæ•´
  },
  
  // é¢„è§ˆæœåŠ¡å™¨é…ç½®
  preview: {
    host: '0.0.0.0',
    port: 4173,
    cors: true
  }
})
```

## Package.json ä¾èµ–ç®¡ç†

### æ ¸å¿ƒä¾èµ–
```json
{
  "dependencies": {
    "vue": "^3.5.18",
    "vue-router": "^4.5.1", 
    "pinia": "^3.0.3",
    "crypto-js": "^4.2.0",
    "axios": "^1.12.2"
  },
  "devDependencies": {
    "@types/crypto-js": "^4.2.2",
    "@vitejs/plugin-vue": "^6.0.1",
    "typescript": "~5.8.0",
    "vite": "^7.0.6",
    "vue-tsc": "^3.0.4"
  }
}
```

### æ¨èè„šæœ¬
```json
{
  "scripts": {
    "dev": "vite --host",
    "build": "vue-tsc --build && vite build",
    "preview": "vite preview --host",
    "type-check": "vue-tsc --build",
    "lint": "eslint . --fix",
    "clean": "rm -rf dist node_modules/.vite"
  }
}
```

## ESLint é…ç½®

### eslint.config.ts
```typescript
import js from '@eslint/js'
import pluginVue from 'eslint-plugin-vue'
import * as parserVue from 'vue-eslint-parser'
import configTypescript from '@vue/eslint-config-typescript'
import configPrettier from '@vue/eslint-config-prettier'

export default [
  js.configs.recommended,
  ...pluginVue.configs['flat/essential'],
  ...configTypescript(),
  configPrettier,
  
  {
    files: ['**/*.vue', '**/*.ts', '**/*.tsx'],
    languageOptions: {
      parser: parserVue,
      parserOptions: {
        parser: '@typescript-eslint/parser',
        sourceType: 'module'
      }
    },
    rules: {
      // ç™½æ¿ç›¸å…³è§„åˆ™
      'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
      'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
      
      // Vueç»„ä»¶è§„åˆ™
      'vue/multi-word-component-names': 'off',
      'vue/no-unused-vars': 'error',
      
      // TypeScriptè§„åˆ™
      '@typescript-eslint/no-unused-vars': 'error',
      '@typescript-eslint/no-explicit-any': 'warn'
    }
  },
  
  {
    // å¿½ç•¥ç™½æ¿SDKç›¸å…³æ–‡ä»¶çš„æ£€æŸ¥
    ignores: [
      'public/whiteboard/**',
      'src/typings/**/*.d.ts',
      'dist/**',
      'node_modules/**'
    ]
  }
]
```

## Git é…ç½®

### .gitignore æ¨è
```gitignore
# ä¾èµ–
node_modules/
.pnpm-debug.log*

# æ„å»ºäº§ç‰©
dist/
dist-ssr/
*.local

# ç¼–è¾‘å™¨
.vscode/*
!.vscode/extensions.json
.idea/
*.swp
*.swo
*~

# ç¯å¢ƒå˜é‡ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
.env.local
.env.production.local
.env.*.local

# æ—¥å¿—
logs/
*.log
npm-debug.log*
pnpm-debug.log*
yarn-debug.log*
yarn-error.log*

# æ“ä½œç³»ç»Ÿ
.DS_Store
Thumbs.db

# ç™½æ¿ç›¸å…³ä¸´æ—¶æ–‡ä»¶
*.wb
*.yxwb
whiteboard-temp/
```


## CDN å’Œèµ„æºé…ç½®

### ç™½æ¿SDKèµ„æºé…ç½®
```html
<!-- public/index.html -->
<head>
  <!-- ç™½æ¿SDKæ ¸å¿ƒæ–‡ä»¶ -->
  <script src="/whiteboard/WhiteBoardSDK.js"></script>
  <script src="/whiteboard/ToolCollection.js"></script>
  
  <!-- PPTæ¸²æŸ“å™¨ï¼ˆåŠ¨æ€æ–‡æ¡£å¿…éœ€ï¼‰ -->
  <script src="/whiteboard/pptRenderer.js"></script>
  
  <!-- å½•åƒå›æ”¾ï¼ˆå¯é€‰ï¼‰ -->
  <script src="/whiteboard/RecordPlayer.js"></script>
  
  <!-- æ–‡æ¡£è½¬æ¢å™¨ï¼ˆå¯é€‰ï¼‰ -->
  <script src="/whiteboard/DocConverter.js"></script>
</head>
```

### Vite èµ„æºå¤„ç†
```typescript
// vite.config.ts
export default defineConfig({
  // ç¡®ä¿ç™½æ¿èµ„æºæ­£ç¡®å¤„ç†
  assetsInclude: ['**/*.wb', '**/*.yxwb'],
  
  publicDir: 'public',
  
  build: {
    rollupOptions: {
      external: [
        // ç™½æ¿SDKä½œä¸ºå¤–éƒ¨ä¾èµ–
        'WhiteBoardSDK',
        'ToolCollection', 
        'RecordPlayer',
        'DocConverter'
      ]
    }
  }
})
```

## æ€§èƒ½ç›‘æ§é…ç½®

### å¼€å‘ç¯å¢ƒæ€§èƒ½ç›‘æ§
```typescript
// src/utils/performance.ts
if (import.meta.env.DEV) {
  // ç™½æ¿æ€§èƒ½ç›‘æ§
  const originalJoinRoom = WhiteBoardSDK.prototype.joinRoom
  
  WhiteBoardSDK.prototype.joinRoom = function(...args) {
    const start = performance.now()
    const result = originalJoinRoom.apply(this, args)
    
    if (result instanceof Promise) {
      result.then(() => {
        console.log(`ğŸ¯ ç™½æ¿åˆå§‹åŒ–è€—æ—¶: ${performance.now() - start}ms`)
      })
    }
    
    return result
  }
}
```

éµå¾ªè¿™äº›é…ç½®è§„èŒƒå¯ä»¥ç¡®ä¿ç½‘æ˜“äº‘ä¿¡ç™½æ¿é¡¹ç›®çš„ç¨³å®šæ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚